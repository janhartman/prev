#Frame for foo function should remain the same
# as the Frame for foo from test1.prev
#Frame for foo2 function should remain the same
# as the Frame for foo2 from test2.prev
#Frame for foo3 function should remain the same
# as the Frame for foo2 from test3.prev
#static link is taken to be of size 8

{
  A={none:foo(A) where var A:int; fun foo(A:int):int=A};
  A={none:foo(A) where var A:int; fun foo(A:int):int=A}
  :
  1
  where
  fun foo(A:int,B:int):int={
    a=@{none:a where var a:ptr int}
      :
      {
       a= {a={none:b where var b:int}:a where var a:int}+{none:a where var a:int};
       b={none:a where var a:arr[2]int}[+{none:a where var a:int}]
       :
       [int]{
            foo2(1,2,3):
            a
            where
            var b:int;
            fun foo2(a:int,b:int,c:int):void={
                a=foo3(@{none:a where var a:arr[2]ptr int}[0])
                :
                none
                where
                fun foo3(a:int):int={
                    a={a=1:{none:b where var b:int} where var a:int}:
                    a*{none:n where var n:int}
                    where
                    var a:int
                };
                var a:int
            };
            var a:rec(a:arr[2]int,b:char)
        }.b
       where
       var a:int;
       var b:int
      }
      where
      var a:int
  };
  var A:int;
  var B:int
}
